# 抓包分析

![image-20250807224747319](./assets/image-20250807224747319.png)

https://kns.cnki.net/kns8s/search?classid=LSTPFY1C&kw=%E4%B8%AD%E5%8D%B0&korder=SU&language=CHS&uniplatform=NZKPT

没啥好说的，查论文的需求多，所以直接看这个

![image-20250807224832033](./assets/image-20250807224832033.png)

grid接口中有

![image-20250807224928712](./assets/image-20250807224928712.png)

请求头没啥东西，主要是个cookie

![image-20250807224943904](./assets/image-20250807224943904.png)

请求体的话，也没啥加密的

用python测试一下，直接就能拿到

![image-20250807225330477](./assets/image-20250807225330477.png)

这里找登录接口试试

![image-20250807225400060](./assets/image-20250807225400060.png)

请求头参数主要是 `timestamp`、`nonce`、`signature`、`cookie`

![image-20250807225629027](./assets/image-20250807225629027.png)

负载主要是加密了密码

![image-20250807225724564](./assets/image-20250807225724564.png)

响应正常

转python代码看看

测试发现cookie不需要

那就看看请求体的密码加密吧

对了，测试发现还会弹验证码



# 密码加密

![image-20250807230504757](./assets/image-20250807230504757.png)

密码很好跟，就是一个aes256，跟发包堆栈就能看到了

![image-20250807230557505](./assets/image-20250807230557505.png)

这是个标准库的aes

![image-20250807230819832](./assets/image-20250807230819832.png)

![image-20250807230828904](./assets/image-20250807230828904.png)

aes/ecb+b64

接下来用python实现

```python
import base64
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad

def aes_ecb_encrypt(plain_bytes: bytes, aes_key: bytes) -> bytes:
    return AES.new(aes_key, AES.MODE_ECB).encrypt(pad(plain_bytes, AES.block_size))


def encrypt_pwd(password: str) ->str:
    return base64.b64encode(aes_ecb_encrypt(password.encode(), "t8b52yrsoyx66f35".encode())).decode()
```

![image-20250807231608856](./assets/image-20250807231608856.png)



# 验证码

![image-20250807231735604](./assets/image-20250807231735604.png)

这里的checkCode就是验证码接口返回的

![image-20250807231803947](./assets/image-20250807231803947.png)

这个滑块成功的 `csessionid` 就是滑块信息了

看了眼滑块和域名，确定了是阿里231

![image-20250807233636979](./assets/image-20250807233636979.png)

![image-20250807233700017](./assets/image-20250807233700017.png)

接下来就是分析阿里231，这里很难，等大佬带带

